id : (A : Set) -> A -> A
   := \A x. x

id2 : {A : Set} -> A -> A
    := \x. x

pair : {A : Set} {B : A -> Set} -> (a : A) -> B a -> (a : A) * B a
     := \a b. (a , b)

proj1 : {A : Set} {B : A -> Set} -> ((a : A) * B a) -> A
      := \p. p.1

proj2 : {A : Set} {B : A -> Set} (p : (a : A) * B a) -> B (proj1 p)
      := \{A} {B} p. p.2

testrefl : {A : Set} (x : A) -> x = x
         := \x. refl

testid : {A : Set} {x y : A} -> x = y -> x = y
        := \p. p

testsym : {A : Set} {x y : A} -> x = y -> y = x
        := \p. sym p

testtrans : {A : Set} {x y z : A} -> x = y -> y = z -> x = z
        := \p q. trans p q

testap : {A B : Set} (f : A -> B) {x y : A} (p : x = y) -> f x = f y
        := \f p. ap f p

testsymeq : {A : Set} {x y : A} -> x = y -> (x = x) = (y = x)
          := \{A} {x} {y} p. ap (\y. y = x) p

testsym : {A : Set} {x y : A} -> x = y -> y = x
        := \{A} {x} {y} p. coe {x = x} {y = x} (testsymeq {A} {x} {y} p) (refl {A} {x})

testcoerefl : {A : Set} {x : A} {p : A = A} -> coe {A} {A} p x = x
            := refl

testcoecoe : {A B C : Set} {x : A} {p : A = B} {q : B = C} -> (coe {B} {C} q (coe {A} {B} p x)) = coe {A} {C} (trans p q) x
           := refl

testfunext : {A B : Set} {f g : A -> B} -> f = g -> ((a : A) -> f a = g a)
           := \p a. p a

testcoecoe2 : {A1 A2 B C1 C2 : Set} {f : A1 -> A2} {p : (A1 -> A2) = B} {q : B = (C1 -> C2)} {r : (A1 -> A2) = (C1 -> C2)}
            -> (coe {B} {C1 -> C2} q (coe {A1 -> A2} {B} p f)) = coe {A1 -> A2} {C1 -> C2} r f
            := \{A1} {A2} {B} {C1} {C2} {f} {p} {q} {r}. refl {_} {coe {A1 -> A2} {C1 -> C2} r f}

Eq : (A : Set) -> A -> A -> Set
   := \A x y. x = y

-- testeqsigma : (A1 A2 C1 C2 : Set) -> El ((A1 × A2) = (C1 × C2)) = El ((A1 = C1) × (A2 = C2))
--             := \A1 A2 C1 C2. refl

testcoecoe3 : {A1 A2 C1 C2 : Set} {f : A1 × A2} {r : (A1 × A2) = (C1 × C2)}
            -> Eq (C1 × C2) (coe {A1 × A2} {C1 × C2} r f) (coe {A1} {C1} r.1 f.1, coe {A2} {C2} _ f.2)
            := \{A1} {A2} {C1} {C2} {f} {r}. refl {_} {coe {A1 × A2} {C1 × C2} r f}


-- testcoecoe3 : {A1 A2 B C1 C2 : Set} {f : A1 × A2} {p : (A1 × A2) = B} {q : B = (C1 × C2)} {r : (A1 × A2) = (C1 × C2)}
--             -> (coe {B} {C1 × C2} q (coe {A1 × A2} {B} p f)) = coe {A1 × A2} {C1 × C2} r f
--             := \{A1} {A2} {B} {C1} {C2} {f} {p} {q} {r}. refl {_} {coe {A1 × A2} {C1 × C2} r f}
